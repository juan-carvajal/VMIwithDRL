\documentclass{elsarticle}

%\usepackage{lineno,hyperref}
%\modulolinenumbers[5]


%%%%%%%%%%%%%%%%%%%%%%%
%% Elsevier bibliography styles
%%%%%%%%%%%%%%%%%%%%%%%
%% To change the style, put a % in front of the second line of the current style and
%% remove the % from the second line of the style you would like to use.
%%%%%%%%%%%%%%%%%%%%%%%

%% Numbered
%\bibliographystyle{model1-num-names}

%% Numbered without titles
%\bibliographystyle{model1a-num-names}

%% Harvard
%\bibliographystyle{model2-names.bst}\biboptions{authoryear}

%% Vancouver numbered
%\usepackage{numcompress}\bibliographystyle{model3-num-names}

%% Vancouver name/year
\usepackage{numcompress}\bibliographystyle{model4-names}
\usepackage{textcomp}
\biboptions{authoryear}
\usepackage{tikz}


%% APA style
%\bibliographystyle{model5-names}\biboptions{authoryear}

% AMA style
%\usepackage{numcompress}\bibliographystyle{model6-num-names}

%% `Elsevier LaTeX' style
%\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{frontmatter}

\title{Vendor Managed Inventory Problem for Blood Platelets: a Two Stage Deep Reinforcement Learning Approach}

\author[1]{Andres F. Osorio}
\author[2]{Juan D. Carvajal}


\address[1]{afosorio@icesi.edu.co}
\address[2]{juan030698@hotmail.com}


\begin{abstract}
	This paper presents an application of Deep Reinforcement techniques 
\end{abstract}


\end{frontmatter}

%\linenumbers

\section{Introduction}

\section{Literature Review}

\section{Problem Definition}

	\subsection{Context}
		In general terms, the supply chain of human blood products its very complicated. Blood products, specially platelets, have very short expiration periods (around 5 days). Because of this, blood managing entities , like donor centers, face great issues estimating and planning production of these vital products. These issues can be of two types, the first one, its about expiration levels, if the donor center produces too much platelets (overestimating the demand), these limited and costly to produce items will go to waste, generating high costs for the entity, and providing no benefit to final users.The second kind of issue, is related to product stock outs (underestimating the demand).Its clear that stock outs are a much more important problem for the donor centers, because these can result in increased risk of death for those needing the platelets.The gravity of this problems is only increased when multiple hospitals or medical centers, with different demand distributions are dependent on the supplies from the donor center.The basic decision for a donor center consists of two parts, the first one, its about how much to produce. Human blood can be transformed and separated into its basic constituents (platelets among these)using a process called blood fractionation,usually performed centrifuging the blood.This process is carried out using specially designed blood bags,which can be single, double, triple or quadruple.Only the last two (the most expensive ones) can be used to extract platelets, so the donor center must know how many of these bags to use in the total donor pool.The second problem its about how much to deliver to each medical center, given its demand distribution and the current inventory of the donor center.
		This problem is essentially a particular case of a Vendor Managed Inventory System, where a distribution center has to supply each of its customers based on individual needs and current capacity.
		\subsection{Modeling}
		To model such a system,a 4 medical center distribution has been considered, but the model should be easily scaled to an arbitrary number of medical centers.The medical centers will be referred from know on as hospitals.
		Each hospital has an internal inventory, visible to the donor center, this inventory is represented by a 5-tuple:
		\def\layersep{2.5cm}
		
		\begin{tikzpicture}[shorten >=1pt,->,draw=black!50, node distance=\layersep]
		\tikzstyle{every pin edge}=[<-,shorten <=1pt]
		\tikzstyle{neuron}=[circle,fill=black!25,minimum size=17pt,inner sep=0pt]
		\tikzstyle{input neuron}=[neuron, fill=green!50];
		\tikzstyle{output neuron}=[neuron, fill=red!50];
		\tikzstyle{hidden neuron}=[neuron, fill=blue!50];
		\tikzstyle{annot} = [text width=4em, text centered]
		
		% Draw the input layer nodes
		\foreach \name / \y in {1,...,4}
		% This is the same as writing \foreach \name / \y in {1/1,2/2,3/3,4/4}
		\node[input neuron, pin=left:Input \#\y] (I-\name) at (0,-\y) {};
		
		% Draw the hidden layer nodes
		\foreach \name / \y in {1,...,5}
		\path[yshift=0.5cm]
		node[hidden neuron] (H-\name) at (\layersep,-\y cm) {};
		
		% Draw the output layer node
		\node[output neuron,pin={[pin edge={->}]right:Output}, right of=H-3] (O) {};
		
		% Connect every node in the input layer with every node in the
		% hidden layer.
		\foreach \source in {1,...,4}
		\foreach \dest in {1,...,5}
		\path (I-\source) edge (H-\dest);
		
		% Connect every node in the hidden layer with the output layer
		\foreach \source in {1,...,5}
		\path (H-\source) edge (O);
		
		% Annotate the layers
		\node[annot,above of=H-1, node distance=1cm] (hl) {Hidden layer};
		\node[annot,left of=hl] {Input layer};
		\node[annot,right of=hl] {Output layer};
		\end{tikzpicture}
		
		
		
		
		

\section{Methodology}

		The deep reinforcement learning model model was developed using the Tensorflow, the integer programming model was solved using pulp the integration was carried out using the Python
		
		\cite{Feynman1963118}
		\cite{Dirac1953888}
		
	\subsection{Two Stage Deep Reinforcement Learning Framework}
	
	In our framework, deep reinforcement learning is used to represent the actual of the blood centre, incorporating variability in donation and demand. Features such as perishability. Integer programming is used to support decisions concerning the allocation of blood platelets to the hospitals.


\subsection{Deep Reinforcement Learning}


\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle Q(s_{t},a_{t}) \longleftarrow  (1 - \alpha ).Q(s_{t},a_{t}) + \alpha .(r_{t} + \gamma . \max Q(s_{t+1},a))\\
	\end{array}
	\label{eq:Eq32}
	\end{equation}	
		



\subsection{Integer Programming Model}

		
	\textbf{Objective Function}
	\begin{equation}
	\begin{array}{ll@{}ll}
	\min  & \displaystyle\sum\limits_{h \in H}&(I_{h0}CV + F_{h}CF)\\
	\end{array}
	\label{eq:Eq31}
	\end{equation}

	\textbf{Constraints}
	
	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle I_{h0} = \max(0, I_{h1} + X_{h1} - D_{h})\\
	\end{array}
	\label{eq:Eq32}
	\end{equation}	
		
	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle F_{h} = \max(0, D_{h} - &\sum\limits_{r \in R}(I_{hr} + X_{hr}))\\
	\end{array}
	\label{eq:Eq33}	
	\end{equation}
	
	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle F_{h} \leq \frac{1}{\| H \|} &\sum\limits_{h \in H}(F_{h})\\
	\end{array}
	\label{eq:Eq33}	
	\end{equation}
	
	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle A_{r} = \sum\limits_{h \in H}(X_{hr})\\
	\end{array}
	\label{eq:Eq33}	
	\end{equation}

	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle \frac{\sum\limits_{r \in R}(I_{hr}+X_{hr})}{D_{h}} = \frac {\sum\limits_{r \in R}(I_{h+1r}+X_{h+1r})}{D_{h+1}} \ \ \forall h<4 \\
	\end{array}
	\label{eq:Eq33}	
	\end{equation}

Constraints 2 and 3 can be linearised as follows:
 

Linearisation Equation 2
  	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle -I_{h1} - X_{h1} + D_{h} \leq M*YI_{h0} \ \ \forall \ \ h\\
	\end{array}
	\label{eq:Eq33}	
	\end{equation}


  	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle I_{h1} + X_{h1} - D_{h} \leq M(1-YI_{h0}) \ \ \forall \ \ h\\
	\end{array}
	\label{eq:Eq33}	
	\end{equation}

  	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle I_{h0} \geq 0 \ \ \forall \ \ h\\
	\end{array}
	\label{eq:Eq33}	
	\end{equation}


  	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle I_{h0} \geq I_{h1} + X_{h1} - D_{h} \ \ \forall \ \ h\\
	\end{array}
	\label{eq:Eq33}	
	\end{equation}

  	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle I_{h0} \leq M(1-YI_{h0}) \ \ \forall \ \ h\\
	\end{array}
	\label{eq:Eq33}	
	\end{equation}

	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle I_{h0} \leq I_{h1} + X_{h1} - D_{h} +M*YI_{h0} \ \ \forall h\\
	\end{array}
	\label{eq:Eq32}
	\end{equation}	
	
	
Linearisation Equation 3
	
	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle - D_{h} + \sum\limits_{r \in R}(I_{hr} + X_{hr}) \leq M*YF_{h} \ \ \forall h\\
	\end{array}
	\label{eq:Eq32}
	\end{equation}	
	
	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle D_{h} - \sum\limits_{r \in R}(I_{hr} + X_{hr}) \leq M*(1-YF_{h}) \ \ \forall h\\
	\end{array}
	\label{eq:Eq32}
	\end{equation}	
	
	  	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle F_{h} \geq 0 \ \ \forall \ \ h\\
	\end{array}
	\label{eq:Eq33}	
	\end{equation}


  	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle F_{h} \geq D_{h} - \sum\limits_{r \in R}(I_{hr} + X_{hr}) \ \ \forall \ \ h\\
	\end{array}
	\label{eq:Eq33}	
	\end{equation}

	
		\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle F_{h} \leq M(1-YF_{h}) \ \ \forall \ \ h\\
	\end{array}
	\label{eq:Eq33}	
	\end{equation}

	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle F_{h} \leq D_{h} - \sum\limits_{r \in R}(I_{hr} + X_{hr}) +M*YF_{h} \ \ \forall h\\
	\end{array}
	\label{eq:Eq32}
	\end{equation}	
	
Once the model has been run, the inventory in each hospital is updated as follows:

	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle I_{hr} = \max(0, I_{hr+1} + X_{h} - \max(0,D_{h}- \sum\limits_{r \in R}(I_{hr} + X_{hr}))) \ \ \forall h, \ r \neq 0 , 4 \\
	\end{array}
	\label{eq:Eq32}
	\end{equation}	

	
	\begin{equation}
	\begin{array}{ll@{}ll}
	& \displaystyle I_{h4} = \max(0, X_{4} - \max(0,D_{h}- \sum\limits_{r \in R}(I_{hr} + X_{hr})))\\
	\end{array}
	\label{eq:Eq32}
	\end{equation}	

\section{Case study}

\section{Results}

\bibliography{mybibfile}

\end{document}